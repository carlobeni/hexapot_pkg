<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

<xacro:include filename="legs_uttu.gazebo.xacro"/>

  <!-- Propiedades comunes -->
  <xacro:property name="connect_offset" value="0.02633"/>
  <xacro:property name="thigh_offset_y" value="-0.0645"/>
  <xacro:property name="thigh_offset_z" value="-0.0145"/>

  <!-- Macro principal de la pierna -->
  <xacro:macro name="leg_uttu_v0" params="parent xyz rpy suffix">

    <!-- ===================== -->
    <!--   JOINT C1 -> Cuerpo  -->
    <!-- ===================== -->
    <joint name="j_c1_${suffix}" type="revolute">
      <parent link="${parent}"/>
      <child link="c1_${suffix}"/>
      <origin xyz="${xyz}" rpy="${rpy}"/>
      <axis xyz="1 0 0"/>
      <limit effort="2.8" velocity="5.6548668" lower="-2.6179939" upper="2.6179939"/>
    </joint>

    <!-- ===================== -->
    <!--   LINK C1             -->
    <!-- ===================== -->
    <link name="c1_${suffix}">
      <inertial>
        <origin xyz="0 -${connect_offset} 0"/>
        <mass value="0.01"/>
        <inertia ixx="0.00"  ixy="0.00"  ixz="0.00" iyy="0.00" iyz="0.00" izz="0.00" />
      </inertial>

      <visual>
        <origin xyz="0 -0.0252 0"/>
        <geometry>
          <mesh filename="$(find hexapod_pkg)/meshes/connect.STL"/>
        </geometry>
          <material name="Blue">
            <color rgba="0.0 0.0 0.2 1.0"/>
          </material>
      </visual>

      <collision>
        <origin xyz="0 -${connect_offset} 0"/>
        <geometry>
          <mesh filename="$(find hexapod_pkg)/meshes/connect_coll.STL"/>
        </geometry>
      </collision>
    </link>

    <!-- ===================== -->
    <!--   JOINT C2 -> C1      -->
    <!-- ===================== -->
    <joint name="j_c2_${suffix}" type="fixed">
      <parent link="c1_${suffix}"/>
      <child link="c2_${suffix}"/>
      <origin xyz="0 -0.054 0" rpy="0 1.5704 3.14159"/>
    </joint>

    <!-- ===================== -->
    <!--   LINK C2             -->
    <!-- ===================== -->
    <link name="c2_${suffix}">
      <inertial>
        <origin xyz="0 -${connect_offset} 0"/>
        <mass value="0.01"/>
        <inertia ixx="0.00"  ixy="0.00"  ixz="0.00" iyy="0.00" iyz="0.00" izz="0.00" />
      </inertial>

    <visual>
      <origin xyz="0 -0.0252 0"/>
      <geometry>
        <mesh filename="$(find hexapod_pkg)/meshes/connect.STL"/>
      </geometry>
          <material name="Blue">
            <color rgba="0.0 0.0 0.2 1.0"/>
          </material>
    </visual>

    <collision>
        <origin xyz="0 -${connect_offset} 0"/>
        <geometry>
          <mesh filename="$(find hexapod_pkg)/meshes/connect_coll.STL"/>
        </geometry>
      </collision>
    </link>

    <!-- ===================== -->
    <!--   JOINT THIGH         -->
    <!-- ===================== -->
    <joint name="j_thigh_${suffix}" type="revolute">
      <parent link="c2_${suffix}"/>
      <child link="thigh_${suffix}"/>
      <origin xyz="0 0 0" rpy="0 3.14159 3.14159"/>
      <axis xyz="1 0 0"/>
      <limit effort="2.8" velocity="5.6548668" lower="-2.6179939" upper="2.6179939"/>
    </joint>

    <!-- ===================== -->
    <!--   LINK THIGH          -->
    <!-- ===================== -->
    <link name="thigh_${suffix}">
      <inertial>
        <origin xyz="0 0 0"/>
        <mass value="0.05"/>
        <inertia ixx="0.00"  ixy="0.00"  ixz="0.00" iyy="0.00" iyz="0.00" izz="0.00" />
      </inertial>

      <visual>
        <origin xyz="0 0 0"/>
        <geometry>
          <mesh filename="$(find hexapod_pkg)/meshes/thigh_l.STL"/>
        </geometry>
          <material name="Grey">
            <color rgba="0.20 0.20 0.20 1.0"/>
          </material>
      </visual>

      <collision>
        <origin xyz="0 0 0"/>
        <geometry>
          <mesh filename="$(find hexapod_pkg)/meshes/thigh_l_coll.STL"/>
        </geometry>
      </collision>
    </link>

    <!-- ===================== -->
    <!--   JOINT TIBIA         -->
    <!-- ===================== -->
    <joint name="j_tibia_${suffix}" type="revolute">
      <parent link="thigh_${suffix}"/>
      <child link="tibia_${suffix}"/>
      <origin xyz="0 ${thigh_offset_y} ${thigh_offset_z}" rpy="-1.5707 0 3.14159"/>
      <axis xyz="1 0 0"/>
      <limit effort="2.8" velocity="5.6548668" lower="-2.6179939" upper="2.6179939"/>
    </joint>

    <!-- ===================== -->
    <!--   LINK TIBIA          -->
    <!-- ===================== -->
    <link name="tibia_${suffix}">
      <inertial>
        <origin xyz="0 0 0"/>
        <mass value="0.06"/>
        <inertia ixx="0.01"  ixy="0.00"  ixz="0.00" iyy="0.01" iyz="0.00" izz="0.01" />
      </inertial>

      <visual>
        <origin xyz="0 0 0"/>
        <geometry>
          <mesh filename="$(find hexapod_pkg)/meshes/tibia_l.STL"/>
        </geometry>
          <material name="Blue">
            <color rgba="0.0 0.0 0.2 1.0"/>
          </material>
      </visual>

      <collision>
        <origin xyz="0 0 0"/>
        <geometry>
          <mesh filename="$(find hexapod_pkg)/meshes/tibia_l_coll.STL"/>
        </geometry>
      </collision>
    </link>

  <!-- ===================== -->
  <!--   TRANSMISSION         -->
  <!-- ===================== -->

  <transmission name="t_c1_${suffix}">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="j_c1_${suffix}">
      <hardwareInterface>EffortJointInterface</hardwareInterface>    
    </joint>
    <actuator name="m_c1_${suffix}">
      <hardwareInterface>EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>


   <transmission name="t_thigh_${suffix}">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="j_thigh_${suffix}">
      <hardwareInterface>EffortJointInterface</hardwareInterface>    
    </joint>
    <actuator name="m_thigh_${suffix}">
      <hardwareInterface>EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>


   <transmission name="t_tibia_${suffix}">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="j_tibia_${suffix}">
      <hardwareInterface>EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="m_tibia_${suffix}">
      <hardwareInterface>EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  </xacro:macro>
</robot>
